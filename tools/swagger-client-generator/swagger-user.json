{"basePath":"/api/cps/user/v1","consumes":["application/json"],"definitions":{"AccessToken":{"properties":{"access_token":{"type":"string"}},"type":"object"},"ApiKey":{"properties":{"api_key":{"type":"string"},"email":{"type":"string"}},"required":["api_key"],"type":"object"},"AuditRecord":{"properties":{"details":{"title":"Details","type":"object"},"id":{"title":"Id","type":"string"},"message":{"title":"Message","type":"string"},"proj_key":{"title":"Proj Key","type":"string","x-nullable":true},"timestamp":{"format":"datetime","title":"Timestamp","type":"string"},"type":{"title":"Type","type":"string"},"user_key":{"title":"User Key","type":"string"}},"required":["id","timestamp","user_key","type","message","details","proj_key"],"title":"AuditRecord","type":"object"},"ErrorResponse":{"properties":{"error":{"description":"Description of the error.","type":"string"}},"required":["error"],"type":"object"},"OidcTokenResponse":{"properties":{"access_token":{"type":"string"},"id_token":{"type":"string"},"refresh_token":{"type":"string"}},"required":["id_token","refresh_token"],"type":"object"},"Project":{"additionalProperties":{"items":{"$ref":"#/definitions/UserDetails"},"type":"array"},"properties":{"date":{"format":"datetime","type":"string"},"name":{"type":"string"},"proj_key":{"type":"string"},"role":{"$ref":"#/definitions/UserType"}},"type":"object"},"ProjectUserAssignment":{"properties":{"role":{"description":"The role to assign to the user","type":"string"},"username":{"description":"The username","type":"string"}},"required":["username","role"],"type":"object"},"ServiceAccount":{"properties":{"credentials":{"properties":{"password":{"type":"string"},"username":{"type":"string"}},"required":["username","password"],"type":"object"},"name":{"type":"string"},"user_key":{"type":"string"}},"required":["user_key"],"type":"object"},"SuccessMessage":{"properties":{"success":{"description":"Human readable message.","type":"string"}},"required":["success"],"type":"object"},"TokenResponse":{"properties":{"token":{"description":"The delete confirmation token.","type":"string"}},"required":["token"],"type":"object"},"UserDetails":{"properties":{"email":{"type":"string"},"role":{"type":"string"},"username":{"type":"string"}},"type":"object"},"UserType":{"enum":["assignee","owner"],"type":"string"}},"info":{"title":"User Management API","version":"1.2.0"},"paths":{"/admin/audits":{"get":{"description":"List audits globally","operationId":"list_audits","parameters":[{"in":"query","name":"user_key","required":false,"type":"string"},{"in":"query","name":"type_","required":false,"type":"string"},{"in":"query","name":"search_term","required":false,"type":"string"},{"format":"datetime","in":"query","name":"before","required":false,"type":"string"},{"format":"datetime","in":"query","name":"after","required":false,"type":"string"},{"default":50,"in":"query","name":"limit","type":"integer"}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"properties":{"audits":{"items":{"$ref":"#/definitions/AuditRecord"},"type":"array"}},"required":["audits"],"type":"object"}},"401":{"description":"Unauthorized.","schema":{"$ref":"#/definitions/ErrorResponse"}},"404":{"description":"Project does not exist.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Admin"],"x-swagger-router-controller":"oidc_user_mngt.controllers.admin"}},"/admin/projects/all":{"get":{"description":"List all projects","operationId":"list_all_projects","produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"items":{"$ref":"#/definitions/Project"},"type":"array"}},"404":{"description":"Project does not exist.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Admin"],"x-swagger-router-controller":"oidc_user_mngt.controllers.admin"}},"/admin/users/pending":{"get":{"description":"List pending user requests.","operationId":"list_pending_users","parameters":[{"in":"query","name":"term","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"items":{"$ref":"#/definitions/UserDetails"},"type":"array"}},"401":{"description":"Unauthorized","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Admin"],"x-swagger-router-controller":"oidc_user_mngt.controllers.admin"}},"/admin/users/{user_key}/confirmation":{"post":{"consumes":["application/json"],"description":"Confirm a pending user.","operationId":"confirm_user","parameters":[{"in":"path","name":"user_key","required":true,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"OK"},"401":{"description":"Unauthorized","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Admin"],"x-swagger-router-controller":"oidc_user_mngt.controllers.admin"}},"/oidc/authenticate":{"get":{"description":"Redirect to the OIDC authenticate endpoint.","operationId":"authenticate","produces":["text/plain"],"responses":{"302":{"description":"Redirect to the OIDC authenticate endpoint"}},"tags":["Oidc"],"x-swagger-router-controller":"oidc_user_mngt.controllers.oidc"}},"/oidc/register_user":{"post":{"description":"Register a new user, provided a valid access_token and id_token from the oidc provider.","operationId":"register_user","parameters":[{"in":"body","name":"data","required":true,"schema":{"properties":{"access_token":{"description":"OIDC access_token signed by the provider","type":"string"},"id_token":{"description":"OIDC id_token signed by the provider","type":"string"}},"required":["access_token","id_token"],"title":"RegisterUserRequestBody","type":"object"}}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/UserDetails"}}},"tags":["Oidc"],"x-swagger-router-controller":"oidc_user_mngt.controllers.oidc"}},"/oidc/token":{"get":{"deprecated":true,"description":"Retrieve the user access and identity tokens using either the code or the refresh_token.","operationId":"token","parameters":[{"description":"The oidc code response","in":"query","name":"code","required":false,"type":"string"},{"description":"The oidc code response","in":"query","name":"refresh_token","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/OidcTokenResponse"}}},"tags":["Oidc"],"x-swagger-router-controller":"oidc_user_mngt.controllers.oidc"},"post":{"description":"Retrieve the user access and identity tokens using either the code or the refresh_token.","operationId":"create_tokens","parameters":[{"in":"body","name":"body","schema":{"properties":{"code":{"description":"The oidc code response","type":"string"},"refresh_token":{"description":"The refresh token","type":"string"}},"title":"CreateTokensRequestBody","type":"object"}}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/OidcTokenResponse"}}},"tags":["Oidc"],"x-swagger-router-controller":"oidc_user_mngt.controllers.oidc"}},"/permissions":{"get":{"description":"Get the global permissions for users.","operationId":"global_permissions","produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"additionalProperties":{"type":"boolean"},"type":"object"}},"401":{"description":"Unauthorized","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Settings"],"x-swagger-router-controller":"oidc_user_mngt.controllers.global"}},"/projects":{"get":{"description":"List all projects assigned to a user","operationId":"list_projects","parameters":[{"description":"filter for the user role","in":"query","name":"role","required":false,"type":"string"},{"default":true,"in":"query","name":"include_collaborators","required":false,"type":"boolean"}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"items":{"$ref":"#/definitions/Project"},"type":"array"}},"404":{"description":"Project does not exist.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"},"post":{"description":"Create a new project","operationId":"create","parameters":[{"in":"body","name":"data","required":true,"schema":{"properties":{"name":{"description":"Name of the project","type":"string"},"proj_key":{"description":"Internal project key to use. (use only if you really know what you are doing)","type":"string"}},"required":["name"],"title":"CreateProjectRequestBody","type":"object"}}],"produces":["application/json"],"responses":{"200":{"description":"New project details","schema":{"$ref":"#/definitions/Project"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"}},"/projects/{proj_key}":{"delete":{"description":"Delete a project.","operationId":"delete","parameters":[{"description":"The project key","in":"path","name":"proj_key","required":true,"type":"string"},{"description":"The delete confirmation token","in":"query","name":"confirmation_token","required":true,"type":"string"}],"produces":["application/json"],"responses":{"204":{"description":"Project deleted successfully."},"403":{"description":"The user that is executing this operation is not an owner of the project.","schema":{"$ref":"#/definitions/ErrorResponse"}},"404":{"description":"Project not found.","schema":{"$ref":"#/definitions/ErrorResponse"}},"409":{"description":"User not assigned to project.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"},"get":{"description":"Returns the details of the project","operationId":"details","parameters":[{"description":"The project key","in":"path","name":"proj_key","required":true,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/Project"}},"401":{"description":"Unauthorized.","schema":{"$ref":"#/definitions/ErrorResponse"}},"404":{"description":"Project does not exist.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"}},"/projects/{proj_key}/audits":{"get":{"description":"List audits related to the project","operationId":"list_audits_in_project","parameters":[{"description":"The project key","in":"path","name":"proj_key","required":true,"type":"string"},{"in":"query","name":"user_key","required":false,"type":"string"},{"in":"query","name":"type_","required":false,"type":"string"},{"in":"query","name":"search_term","required":false,"type":"string"},{"format":"datetime","in":"query","name":"before","required":false,"type":"string"},{"format":"datetime","in":"query","name":"after","required":false,"type":"string"},{"default":50,"in":"query","name":"limit","type":"integer"}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"properties":{"audits":{"items":{"$ref":"#/definitions/AuditRecord"},"type":"array"}},"required":["audits"],"type":"object"}},"401":{"description":"Unauthorized.","schema":{"$ref":"#/definitions/ErrorResponse"}},"404":{"description":"Project does not exist.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"}},"/projects/{proj_key}/delete":{"get":{"description":"Get a delete confirmation token for the provided project.","operationId":"get_delete_confirmation_token","parameters":[{"description":"The project key","in":"path","name":"proj_key","required":true,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"Confirmation token.","schema":{"$ref":"#/definitions/TokenResponse"}},"403":{"description":"The user that is executing this operation is not an owner of the project.","schema":{"$ref":"#/definitions/ErrorResponse"}},"404":{"description":"Project not found.","schema":{"$ref":"#/definitions/ErrorResponse"}},"409":{"description":"User not assigned to project.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"}},"/projects/{proj_key}/is_authorized":{"get":{"description":"Provide user-key and project-key to coordinates a project","operationId":"is_authorized","parameters":[{"description":"The project key","in":"path","name":"proj_key","required":true,"type":"string"},{"description":"The specific role to probe","in":"query","name":"role","required":false,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/SuccessMessage"}},"401":{"description":"Unauthorized","schema":{"$ref":"#/definitions/ErrorResponse"}},"404":{"description":"Project does not exist.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"}},"/projects/{proj_key}/token":{"get":{"description":"Request a token granting access to the current project","operationId":"get_project_token","parameters":[{"description":"The project key","in":"path","name":"proj_key","required":true,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/AccessToken"}},"401":{"description":"Unauthorized.","schema":{"$ref":"#/definitions/ErrorResponse"}},"404":{"description":"Project does not exist.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"}},"/projects/{proj_key}/users":{"get":{"description":"List all users belonging to a project","operationId":"list_users","parameters":[{"description":"The project key","in":"path","name":"proj_key","required":true,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"additionalProperties":{"items":{"$ref":"#/definitions/UserDetails"},"type":"array"},"type":"object"}},"401":{"description":"Unauthorized.","schema":{"$ref":"#/definitions/ErrorResponse"}},"404":{"description":"User does not exist.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"},"post":{"description":"Assign a new user to a project","operationId":"add_user","parameters":[{"description":"The project key","in":"path","name":"proj_key","required":true,"type":"string"},{"in":"body","name":"data","required":true,"schema":{"$ref":"#/definitions/ProjectUserAssignment"}}],"produces":["application/json"],"responses":{"200":{"description":"User assigned to project.","schema":{"$ref":"#/definitions/SuccessMessage"}},"400":{"description":"Invalid new_user_type.","schema":{"$ref":"#/definitions/ErrorResponse"}},"403":{"description":"The user that's performing this operation does not have permission to assign the user.","schema":{"$ref":"#/definitions/ErrorResponse"}},"404":{"description":"User that's going to be assigned doesn't exist, or the project doesn't exist.","schema":{"$ref":"#/definitions/ErrorResponse"}},"409":{"description":"Reassigning the user would leave the project in an invalid state.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"},"put":{"description":"Assign a new user to a project","operationId":"edit_user","parameters":[{"description":"The project key","in":"path","name":"proj_key","required":true,"type":"string"},{"in":"body","name":"data","required":true,"schema":{"$ref":"#/definitions/ProjectUserAssignment"}}],"produces":["application/json"],"responses":{"200":{"description":"User assigned to project.","schema":{"$ref":"#/definitions/SuccessMessage"}},"400":{"description":"Invalid new_user_type.","schema":{"$ref":"#/definitions/ErrorResponse"}},"403":{"description":"The user that's performing this operation does not have permission to assign the user.","schema":{"$ref":"#/definitions/ErrorResponse"}},"404":{"description":"User that's going to be assigned doesn't exist, or the project doesn't exist.","schema":{"$ref":"#/definitions/ErrorResponse"}},"409":{"description":"Reassigning the user would leave the project in an invalid state.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"}},"/projects/{proj_key}/users/{username}":{"delete":{"description":"Delete an user from a project.","operationId":"remove_user","parameters":[{"description":"The project key","in":"path","name":"proj_key","required":true,"type":"string"},{"description":"The username for the user","in":"path","name":"username","required":true,"type":"string"}],"produces":["application/json"],"responses":{"204":{"description":"User deleted from project successfully."},"403":{"description":"The user that is executing this operation is not an owner of the project.","schema":{"$ref":"#/definitions/ErrorResponse"}},"404":{"description":"Project or user not found.","schema":{"$ref":"#/definitions/ErrorResponse"}},"409":{"description":"User not assigned to project, or the project only has one owner left.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]}],"tags":["Projects"],"x-swagger-router-controller":"oidc_user_mngt.controllers.project"}},"/user/api_key":{"get":{"description":"Show the API Key for your user","operationId":"api_key_get","produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/ApiKey"}}},"security":[{"Bearer":[]}],"tags":["Users"],"x-swagger-router-controller":"oidc_user_mngt.controllers.user"},"post":{"description":"Create an API Key for your user","operationId":"api_key_create","produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/ApiKey"}}},"security":[{"Bearer":[]}],"tags":["User"],"x-swagger-router-controller":"oidc_user_mngt.controllers.user"}},"/user/current":{"get":{"description":"Gets the current user's details.","operationId":"get_current_user_details","parameters":[],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/UserDetails"}}},"security":[{"Bearer":[]}],"tags":["Users"],"x-swagger-router-controller":"oidc_user_mngt.controllers.user"}},"/user/impersonate":{"post":{"description":"Request an impersonate user token.","operationId":"impersonate_user_token","parameters":[{"in":"body","name":"body","required":true,"schema":{"properties":{"impersonate_secret":{"type":"string"},"target_user_key":{"type":"string"}},"required":["target_user_key","impersonate_secret"],"title":"ImpersonateUserTokenRequestBody","type":"object"}}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/TokenResponse"}},"401":{"description":"Unauthorized.","schema":{"$ref":"#/definitions/ErrorResponse"}},"403":{"description":"The user that's performing this operation does not have permission or the impersonate secret isn't valid.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]},{"UserAPIKey":[]}],"tags":["Users"],"x-swagger-router-controller":"oidc_user_mngt.controllers.user"}},"/user/search":{"get":{"description":"Search for users matching the email or name. Depending on the user's permissions, only owners and assignees from their projects may be shown.","operationId":"search","parameters":[{"description":"Search term","in":"query","name":"term","required":true,"type":"string"}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"items":{"$ref":"#/definitions/UserDetails"},"type":"array"}}},"security":[{"Bearer":[]}],"tags":["Users"],"x-swagger-router-controller":"oidc_user_mngt.controllers.user"}},"/user/service_accounts":{"get":{"deprecated":true,"description":"List all service accounts of your user","operationId":"service_accounts_list","produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"items":{"$ref":"#/definitions/ServiceAccount"},"type":"array"}}},"security":[{"Bearer":[]}],"tags":["Users"],"x-swagger-router-controller":"oidc_user_mngt.controllers.user"},"post":{"deprecated":true,"description":"Create a new service accounts for your user","operationId":"service_accounts_create","produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/ServiceAccount"}}},"security":[{"Bearer":[]}],"tags":["Users"],"x-swagger-router-controller":"oidc_user_mngt.controllers.user"}},"/user/token":{"post":{"description":"Request a user API token","operationId":"get_access_token","parameters":[{"in":"body","name":"options","required":false,"schema":{"properties":{"admin":{"default":false,"type":"boolean"}},"title":"GetAccessTokenRequestBody","type":"object"}}],"produces":["application/json"],"responses":{"200":{"description":"OK","schema":{"$ref":"#/definitions/AccessToken"}},"401":{"description":"Unauthorized.","schema":{"$ref":"#/definitions/ErrorResponse"}}},"security":[{"Bearer":[]},{"UserAPIKey":[]}],"tags":["Users"],"x-swagger-router-controller":"oidc_user_mngt.controllers.user"}}},"produces":["application/json"],"schemes":["http","https"],"securityDefinitions":{"Bearer":{"description":"For accessing the API a valid JWT token must be passed in all the queries in\nthe 'Authorization' header.\n\nA valid JWT token is generated by the API and returned.\n\nThe following syntax must be used in the 'Authorization' header :\n    Bearer: xxxxxx.yyyyyyy.zzzzzz\n","in":"header","name":"Authorization","type":"apiKey","x-apikeyInfoFunc":"oidc_user_mngt.utils.connexion_auth.api_key_info"},"UserAPIKey":{"description":"Login using the user credentials. Username is the email address. Password is\nthe API Key.\n","type":"basic","x-basicInfoFunc":"oidc_user_mngt.utils.connexion_auth.basic_auth_info"}},"swagger":"2.0"}
